{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from \"@nestjs/core\";\nimport { ConfigService } from \"@nestjs/config\";\nimport { Logger } from \"@nestjs/common\";\nimport { createServer } from \"https\";\nimport { AppModule } from \"./app.module\";\nimport { HttpExceptionFilter } from \"./http.exception.filter\";\nimport { WsAdapter } from \"./ws.adapter\";\n\nimport cors from \"cors\";\nimport * as fs from \"fs\";\n\nasync function bootstrap() {\n  const AppLogger = new Logger(\"App\");\n  const WsLogger = new Logger(\"Websocket\");\n\n  const keyFile = fs.readFileSync(__dirname + \"/../config/server.key\");\n  const certFile = fs.readFileSync(__dirname + \"/../config/server.crt\");\n\n  const app = await NestFactory.create(AppModule);\n\n  const httpsServer = createServer();\n\n  const config = app.get<ConfigService>(ConfigService);\n  const PORT = config.get<number>(\"PORT\");\n  const WS_PORT = config.get<number>(\"WS_PORT\");\n\n  app.use(cors());\n  app.useGlobalFilters(new HttpExceptionFilter());\n  // app.useWebSocketAdapter(new WsAdapter(httpsServer));\n  try {\n    await app.listen(PORT, async () =>\n      AppLogger.log(`Server is listening at ${await app.getUrl()}`),\n    );\n\n    httpsServer.listen(WS_PORT, () =>\n      WsLogger.log(`Websocket is listening at https://[::1]:${WS_PORT}`),\n    );\n  } catch (error) {\n    AppLogger.error(`Error starting server: ${error}`);\n    WsLogger.error(`Error starting websocket: ${error}`);\n  }\n}\nbootstrap();\n"],"names":["bootstrap","AppLogger","Logger","WsLogger","keyFile","fs","readFileSync","__dirname","certFile","app","NestFactory","create","AppModule","httpsServer","createServer","config","get","ConfigService","PORT","WS_PORT","use","cors","useGlobalFilters","HttpExceptionFilter","listen","log","getUrl","error"],"mappings":";;;;sBAA4B;wBACE;wBACP;uBACM;2BACH;qCACU;6DAGnB;4DACG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEpB,eAAeA;IACb,MAAMC,YAAY,IAAIC,cAAM,CAAC;IAC7B,MAAMC,WAAW,IAAID,cAAM,CAAC;IAE5B,MAAME,UAAUC,IAAGC,YAAY,CAACC,YAAY;IAC5C,MAAMC,WAAWH,IAAGC,YAAY,CAACC,YAAY;IAE7C,MAAME,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAACC,oBAAS;IAE9C,MAAMC,cAAcC,IAAAA,mBAAY;IAEhC,MAAMC,SAASN,IAAIO,GAAG,CAAgBC,qBAAa;IACnD,MAAMC,OAAOH,OAAOC,GAAG,CAAS;IAChC,MAAMG,UAAUJ,OAAOC,GAAG,CAAS;IAEnCP,IAAIW,GAAG,CAACC,IAAAA,aAAI;IACZZ,IAAIa,gBAAgB,CAAC,IAAIC,wCAAmB;IAC5C,uDAAuD;IACvD,IAAI;QACF,MAAMd,IAAIe,MAAM,CAACN,MAAM,UACrBjB,UAAUwB,GAAG,CAAC,CAAC,uBAAuB,EAAE,MAAMhB,IAAIiB,MAAM,GAAG,CAAC;QAG9Db,YAAYW,MAAM,CAACL,SAAS,IAC1BhB,SAASsB,GAAG,CAAC,CAAC,wCAAwC,EAAEN,QAAQ,CAAC;IAErE,EAAE,OAAOQ,OAAO;QACd1B,UAAU0B,KAAK,CAAC,CAAC,uBAAuB,EAAEA,MAAM,CAAC;QACjDxB,SAASwB,KAAK,CAAC,CAAC,0BAA0B,EAAEA,MAAM,CAAC;IACrD;AACF;AACA3B"}