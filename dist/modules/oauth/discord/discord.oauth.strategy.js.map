{"version":3,"sources":["../../../../src/modules/oauth/discord/discord.oauth.strategy.ts"],"sourcesContent":["import { STRATEGIES } from \"@/utils\";\nimport { Inject, Injectable } from \"@nestjs/common\";\nimport { ConfigService } from \"@nestjs/config\";\nimport { PassportStrategy } from \"@nestjs/passport\";\nimport { Profile, Strategy } from \"passport-discord\";\nimport { Done } from \"./discord.types\";\n\n@Injectable()\nexport class DiscordOAuthStrategy extends PassportStrategy(\n  Strategy,\n  STRATEGIES.DISCORD,\n) {\n  constructor(\n    @Inject(ConfigService)\n    private readonly config: ConfigService,\n  ) {\n    super({\n      clientID: config.get<string>(\"DISCORD_CLIENT_ID\"),\n      clientSecret: config.get<string>(\"DISCORD_CLIENT_SECRET\"),\n      callbackURL: config.get<string>(\"DISCORD_CALLBACK_URL\"),\n      scope: [\"identify\", \"email\"],\n    });\n  }\n\n  async validate(\n    _accessToken: string,\n    _refreshToken: string,\n    profileData: Profile,\n    done: Done,\n  ) {\n    const profile = {\n      providerId: profileData.id,\n      username: profileData.username,\n      email: profileData.email,\n      provider: profileData.provider,\n    };\n\n    done(null, profile);\n  }\n}\n"],"names":["DiscordOAuthStrategy","PassportStrategy","Strategy","STRATEGIES","DISCORD","validate","_accessToken","_refreshToken","profileData","done","profile","providerId","id","username","email","provider","constructor","config","clientID","get","clientSecret","callbackURL","scope","Injectable","Inject","ConfigService"],"mappings":";;;;+BAQaA;;;eAAAA;;;uBARc;wBACQ;wBACL;0BACG;iCACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIrBA,uBAAN,mCAAmCC,IAAAA,0BAAgB,EACxDC,yBAAQ,EACRC,iBAAU,CAACC,OAAO;IAclB,MAAMC,SACJC,YAAoB,EACpBC,aAAqB,EACrBC,WAAoB,EACpBC,IAAU,EACV;QACA,MAAMC,UAAU;YACdC,YAAYH,YAAYI,EAAE;YAC1BC,UAAUL,YAAYK,QAAQ;YAC9BC,OAAON,YAAYM,KAAK;YACxBC,UAAUP,YAAYO,QAAQ;QAChC;QAEAN,KAAK,MAAMC;IACb;IA1BAM,YAEmBC,OACjB;QACA,KAAK,CAAC;YACJC,UAAUD,OAAOE,GAAG,CAAS;YAC7BC,cAAcH,OAAOE,GAAG,CAAS;YACjCE,aAAaJ,OAAOE,GAAG,CAAS;YAChCG,OAAO;gBAAC;gBAAY;aAAQ;QAC9B;+BAPiBL;sBAAAA;IAQnB;AAiBF;AA/BajB;IADZuB,IAAAA,kBAAU;IAMNC,aAAAA,IAAAA,cAAM,EAACC,qBAAa;;;eACI,qBAAa,4BAAb,qBAAa;;GAN7BzB"}