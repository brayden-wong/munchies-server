{"version":3,"sources":["../../../../src/modules/oauth/facebook/facebook.controller.ts"],"sourcesContent":["import { Public, CurrentUser } from \"@/utils\";\nimport { ROUTES } from \"@/utils/constants\";\nimport { Controller, Get, Res, UseGuards } from \"@nestjs/common\";\nimport { FacebookOAuthGuard } from \"./facebook.oauth.guard\";\nimport { Profile } from \"passport-facebook\";\nimport { FacebookService } from \"./facebook.service\";\nimport { FacebookUser } from \"./facebook.types\";\nimport { Response } from \"express\";\n\n@Controller(ROUTES.FACEBOOK)\nexport class FacebookController {\n  constructor(private readonly facebookService: FacebookService) {}\n\n  @Public()\n  @Get()\n  @UseGuards(FacebookOAuthGuard)\n  async oauth() {}\n\n  @Public()\n  @Get(\"redirect\")\n  @UseGuards(FacebookOAuthGuard)\n  async callback(@Res() res: Response, @CurrentUser() user: FacebookUser) {\n    const result = await this.facebookService.createProfile(user);\n\n    const queryParams = `?at=${result.auth.at}&rt=${result.auth.rt}&id=${result.auth.session.userId}`;\n\n    return res\n      .status(200)\n      .redirect(`${process.env.APP_URL}/--/screens/login/login${queryParams}`);\n  }\n}\n"],"names":["FacebookController","oauth","callback","res","user","result","facebookService","createProfile","queryParams","auth","at","rt","session","userId","status","redirect","process","env","APP_URL","constructor","Public","Get","UseGuards","FacebookOAuthGuard","Res","CurrentUser","Controller","ROUTES","FACEBOOK"],"mappings":";;;;+BAUaA;;;eAAAA;;;uBAVuB;2BACb;wBACyB;oCACb;iCAEH;+BACH;yBACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGZA,qBAAN;IAGL,MAGMC,QAAQ,CAAC;IAEf,MAGMC,SAAS,AAAOC,GAAa,EAAE,AAAeC,IAAkB,EAAE;QACtE,MAAMC,SAAS,MAAM,IAAI,CAACC,eAAe,CAACC,aAAa,CAACH;QAExD,MAAMI,cAAc,CAAC,IAAI,EAAEH,OAAOI,IAAI,CAACC,EAAE,CAAC,IAAI,EAAEL,OAAOI,IAAI,CAACE,EAAE,CAAC,IAAI,EAAEN,OAAOI,IAAI,CAACG,OAAO,CAACC,MAAM,CAAC,CAAC;QAEjG,OAAOV,IACJW,MAAM,CAAC,KACPC,QAAQ,CAAC,CAAC,EAAEC,QAAQC,GAAG,CAACC,OAAO,CAAC,uBAAuB,EAAEV,YAAY,CAAC;IAC3E;IAlBAW,YAA6Bb,gBAAkC;+BAAlCA;+BAAAA;IAAmC;AAmBlE;;IAjBGc,IAAAA,aAAM;IACNC,IAAAA,WAAG;IACHC,IAAAA,iBAAS,EAACC,sCAAkB;;;GALlBvB;;IAQVoB,IAAAA,aAAM;IACNC,IAAAA,WAAG,EAAC;IACJC,IAAAA,iBAAS,EAACC,sCAAkB;IACbC,aAAAA,IAAAA,WAAG;IAAmBC,aAAAA,IAAAA,kBAAW;;;eAAtB,iBAAQ,4BAAR,iBAAQ;eAAuB,2BAAY,4BAAZ,2BAAY;;GAX3DzB;AAAAA;IADZ0B,IAAAA,kBAAU,EAACC,iBAAM,CAACC,QAAQ;;;eAEqB,gCAAe,4BAAf,gCAAe;;GADlD5B"}