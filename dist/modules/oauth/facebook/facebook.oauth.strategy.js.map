{"version":3,"sources":["../../../../src/modules/oauth/facebook/facebook.oauth.strategy.ts"],"sourcesContent":["import { STRATEGIES } from \"@/utils\";\nimport { Inject, Injectable } from \"@nestjs/common\";\nimport { ConfigService } from \"@nestjs/config\";\nimport { PassportStrategy } from \"@nestjs/passport\";\nimport { Profile, Strategy } from \"passport-facebook\";\nimport { FacebookUser } from \"./facebook.types\";\n\n@Injectable()\nexport class FacebookOAuthStrategy extends PassportStrategy(\n  Strategy,\n  STRATEGIES.FACEBOOK,\n) {\n  constructor(@Inject(ConfigService) private readonly config: ConfigService) {\n    super({\n      clientID: config.get<string>(\"FACEBOOK_CLIENT_ID\"),\n      clientSecret: config.get<string>(\"FACEBOOK_SECRET_ID\"),\n      callbackURL: config.get<string>(\"FACEBOOK_CALLBACK_URL\"),\n      profileFields: [\"id\", \"name\", \"photos\", \"email\"],\n    });\n  }\n\n  async validate(\n    _accessToken: string,\n    _refreshToken: string,\n    profile: Profile,\n    done: (err: any, user: FacebookUser, info?: any) => void,\n  ) {\n    const user: FacebookUser = {\n      name: `${profile.name.givenName} ${profile.name.familyName}`,\n      picture: profile.photos[0].value,\n      provider: \"facebook\",\n      providerId: profile.id,\n    };\n\n    done(null, user);\n  }\n}\n"],"names":["FacebookOAuthStrategy","PassportStrategy","Strategy","STRATEGIES","FACEBOOK","validate","_accessToken","_refreshToken","profile","done","user","name","givenName","familyName","picture","photos","value","provider","providerId","id","constructor","config","clientID","get","clientSecret","callbackURL","profileFields","Injectable","Inject","ConfigService"],"mappings":";;;;+BAQaA;;;eAAAA;;;uBARc;wBACQ;wBACL;0BACG;kCACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIrBA,wBAAN,oCAAoCC,IAAAA,0BAAgB,EACzDC,0BAAQ,EACRC,iBAAU,CAACC,QAAQ;IAWnB,MAAMC,SACJC,YAAoB,EACpBC,aAAqB,EACrBC,OAAgB,EAChBC,IAAwD,EACxD;QACA,MAAMC,OAAqB;YACzBC,MAAM,CAAC,EAAEH,QAAQG,IAAI,CAACC,SAAS,CAAC,CAAC,EAAEJ,QAAQG,IAAI,CAACE,UAAU,CAAC,CAAC;YAC5DC,SAASN,QAAQO,MAAM,CAAC,EAAE,CAACC,KAAK;YAChCC,UAAU;YACVC,YAAYV,QAAQW,EAAE;QACxB;QAEAV,KAAK,MAAMC;IACb;IAvBAU,YAAoDC,OAAuB;QACzE,KAAK,CAAC;YACJC,UAAUD,OAAOE,GAAG,CAAS;YAC7BC,cAAcH,OAAOE,GAAG,CAAS;YACjCE,aAAaJ,OAAOE,GAAG,CAAS;YAChCG,eAAe;gBAAC;gBAAM;gBAAQ;gBAAU;aAAQ;QAClD;+BANkDL;sBAAAA;IAOpD;AAiBF;AA5BarB;IADZ2B,IAAAA,kBAAU;IAKIC,aAAAA,IAAAA,cAAM,EAACC,qBAAa;;;eAA2B,qBAAa,4BAAb,qBAAa;;GAJ9D7B"}