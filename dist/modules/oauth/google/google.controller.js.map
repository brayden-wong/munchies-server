{"version":3,"sources":["../../../../src/modules/oauth/google/google.controller.ts"],"sourcesContent":["import { Controller, Get, Res, UseGuards } from \"@nestjs/common\";\nimport { GoogleService } from \"./google.service\";\n\nimport { ROUTES } from \"@/utils/constants\";\nimport { Public, CurrentUser } from \"@/utils/decorators\";\nimport { GoogleOAuthGuard } from \"./google.oauth.guard\";\nimport { GoogleUser } from \"./google.types\";\nimport { Response } from \"express\";\n\n@Controller(ROUTES.GOOGLE)\nexport class GoogleController {\n  constructor(private readonly googleService: GoogleService) {}\n\n  @Public()\n  @Get()\n  @UseGuards(GoogleOAuthGuard)\n  async googleAuth() {}\n\n  @Public()\n  @Get(\"callback\")\n  @UseGuards(GoogleOAuthGuard)\n  async googleAuthRedirect(\n    @Res() res: Response,\n    @CurrentUser() user: GoogleUser,\n  ) {\n    const result = await this.googleService.createProfile(user);\n\n    const queryParams = `?at=${result.auth.at}&rt=${result.auth.rt}&id=${result.auth.session.userId}`;\n\n    return res\n      .status(200)\n      .redirect(`${process.env.APP_URL}/--/screens/login/login${queryParams}`);\n  }\n}\n"],"names":["GoogleController","googleAuth","googleAuthRedirect","res","user","result","googleService","createProfile","queryParams","auth","at","rt","session","userId","status","redirect","process","env","APP_URL","constructor","Public","Get","UseGuards","GoogleOAuthGuard","Res","CurrentUser","Controller","ROUTES","GOOGLE"],"mappings":";;;;+BAUaA;;;eAAAA;;;wBAVmC;+BAClB;2BAEP;4BACa;kCACH;6BACN;yBACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGZA,mBAAN;IAGL,MAGMC,aAAa,CAAC;IAEpB,MAGMC,mBACJ,AAAOC,GAAa,EACpB,AAAeC,IAAgB,EAC/B;QACA,MAAMC,SAAS,MAAM,IAAI,CAACC,aAAa,CAACC,aAAa,CAACH;QAEtD,MAAMI,cAAc,CAAC,IAAI,EAAEH,OAAOI,IAAI,CAACC,EAAE,CAAC,IAAI,EAAEL,OAAOI,IAAI,CAACE,EAAE,CAAC,IAAI,EAAEN,OAAOI,IAAI,CAACG,OAAO,CAACC,MAAM,CAAC,CAAC;QAEjG,OAAOV,IACJW,MAAM,CAAC,KACPC,QAAQ,CAAC,CAAC,EAAEC,QAAQC,GAAG,CAACC,OAAO,CAAC,uBAAuB,EAAEV,YAAY,CAAC;IAC3E;IArBAW,YAA6Bb,cAA8B;+BAA9BA;6BAAAA;IAA+B;AAsB9D;;IApBGc,IAAAA,kBAAM;IACNC,IAAAA,WAAG;IACHC,IAAAA,iBAAS,EAACC,kCAAgB;;;GALhBvB;;IAQVoB,IAAAA,kBAAM;IACNC,IAAAA,WAAG,EAAC;IACJC,IAAAA,iBAAS,EAACC,kCAAgB;IAExBC,aAAAA,IAAAA,WAAG;IACHC,aAAAA,IAAAA,uBAAW;;;eADA,iBAAQ,4BAAR,iBAAQ;eACC,uBAAU,4BAAV,uBAAU;;GAbtBzB;AAAAA;IADZ0B,IAAAA,kBAAU,EAACC,iBAAM,CAACC,MAAM;;;eAEqB,4BAAa,4BAAb,4BAAa;;GAD9C5B"}