{"version":3,"sources":["../../../../src/modules/oauth/google/google.oauth.strategy.ts"],"sourcesContent":["import { STRATEGIES } from \"@/utils\";\nimport { Inject, Injectable } from \"@nestjs/common\";\nimport { ConfigService } from \"@nestjs/config\";\nimport { PassportStrategy } from \"@nestjs/passport\";\nimport { Strategy, VerifyCallback } from \"passport-google-oauth20\";\nimport type { GoogleProfile, GoogleUser } from \"./google.types\";\n\n@Injectable()\nexport class GoogleOAuthStrategy extends PassportStrategy(\n  Strategy,\n  STRATEGIES.GOOGLE,\n) {\n  constructor(\n    @Inject(ConfigService)\n    private readonly config: ConfigService,\n  ) {\n    super({\n      clientID: config.get<string>(\"GOOGLE_CLIENT_ID\"),\n      clientSecret: config.get<string>(\"GOOGLE_SECRET\"),\n      callbackURL: config.get<string>(\"GOOGLE_CALLBACK_URL\"),\n      scope: [\"email\", \"profile\"],\n    });\n  }\n\n  async validate(\n    _accessToken: string,\n    _refreshToken: string,\n    profile: GoogleProfile,\n    done: VerifyCallback,\n  ) {\n    const { emails, photos, id, provider, displayName, ...rest } = profile;\n\n    const user: GoogleUser = {\n      provider: \"google\",\n      providerId: id,\n      email: emails[0].value,\n      name: displayName,\n      picture: photos[0].value,\n    };\n\n    done(null, user);\n  }\n}\n"],"names":["GoogleOAuthStrategy","PassportStrategy","Strategy","STRATEGIES","GOOGLE","validate","_accessToken","_refreshToken","profile","done","emails","photos","id","provider","displayName","rest","user","providerId","email","value","name","picture","constructor","config","clientID","get","clientSecret","callbackURL","scope","Injectable","Inject","ConfigService"],"mappings":";;;;+BAQaA;;;eAAAA;;;uBARc;wBACQ;wBACL;0BACG;uCACQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAI5BA,sBAAN,kCAAkCC,IAAAA,0BAAgB,EACvDC,+BAAQ,EACRC,iBAAU,CAACC,MAAM;IAcjB,MAAMC,SACJC,YAAoB,EACpBC,aAAqB,EACrBC,OAAsB,EACtBC,IAAoB,EACpB;QACA,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAEC,EAAE,EAAEC,QAAQ,EAAEC,WAAW,EAAE,GAAGC,MAAM,GAAGP;QAE/D,MAAMQ,OAAmB;YACvBH,UAAU;YACVI,YAAYL;YACZM,OAAOR,MAAM,CAAC,EAAE,CAACS,KAAK;YACtBC,MAAMN;YACNO,SAASV,MAAM,CAAC,EAAE,CAACQ,KAAK;QAC1B;QAEAV,KAAK,MAAMO;IACb;IA7BAM,YAEmBC,OACjB;QACA,KAAK,CAAC;YACJC,UAAUD,OAAOE,GAAG,CAAS;YAC7BC,cAAcH,OAAOE,GAAG,CAAS;YACjCE,aAAaJ,OAAOE,GAAG,CAAS;YAChCG,OAAO;gBAAC;gBAAS;aAAU;QAC7B;+BAPiBL;sBAAAA;IAQnB;AAoBF;AAlCavB;IADZ6B,IAAAA,kBAAU;IAMNC,aAAAA,IAAAA,cAAM,EAACC,qBAAa;;;eACI,qBAAa,4BAAb,qBAAa;;GAN7B/B"}