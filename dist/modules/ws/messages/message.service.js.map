{"version":3,"sources":["../../../../src/modules/ws/messages/message.service.ts"],"sourcesContent":["import { Injectable } from \"@nestjs/common\";\nimport { Database, InjectDrizzle, messages } from \"@/modules/drizzle\";\nimport { CreateMessageDto } from \"./message.types\";\nimport { cuid } from \"@/utils/functions\";\n\n@Injectable()\nexport class MessageService {\n  constructor(\n    @InjectDrizzle()\n    private readonly db: Database,\n  ) {}\n\n  async createMessage(userId: string, createMessageDto: CreateMessageDto) {\n    const [message] = await this.db\n      .insert(messages)\n      .values({\n        ...createMessageDto,\n        id: cuid(),\n        authorId: userId,\n      })\n      .returning()\n      .catch((error) => {\n        throw new Error(error.message);\n      });\n\n    return message;\n  }\n}\n"],"names":["MessageService","createMessage","userId","createMessageDto","message","db","insert","messages","values","id","cuid","authorId","returning","catch","error","Error","constructor","Injectable","InjectDrizzle"],"mappings":";;;;+BAMaA;;;eAAAA;;;wBANc;yBACuB;2BAE7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGRA,iBAAN;IAML,MAAMC,cAAcC,MAAc,EAAEC,gBAAkC,EAAE;QACtE,MAAM,CAACC,QAAQ,GAAG,MAAM,IAAI,CAACC,EAAE,CAC5BC,MAAM,CAACC,iBAAQ,EACfC,MAAM,CAAC;YACN,GAAGL,gBAAgB;YACnBM,IAAIC,IAAAA,eAAI;YACRC,UAAUT;QACZ,GACCU,SAAS,GACTC,KAAK,CAAC,CAACC;YACN,MAAM,IAAIC,MAAMD,MAAMV,OAAO;QAC/B;QAEF,OAAOA;IACT;IAnBAY,YAEmBX,GACjB;+BADiBA;kBAAAA;IAChB;AAiBL;AArBaL;IADZiB,IAAAA,kBAAU;IAGNC,aAAAA,IAAAA,sBAAa;;;eACO,iBAAQ,4BAAR,iBAAQ;;GAHpBlB"}